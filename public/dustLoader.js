// Generated by CoffeeScript 1.3.3
if (typeof define !== 'function') { var define = require('amdefine')(module) };

define(['dustjs-linkedin', 'underscore', 'requirejs'], function(dust, _, requirejs) {
  return {
    loadTemplate: function(path, name, callback) {
      if (_.isFunction(name)) {
        callback = name;
        name = this._getAutoName(path);
      } else {
        name = name ? name : this._getAutoName(path);
      }
      console.log("preved");
      return requirejs(['fs'], function(fs) {
        console.log("medved");
        return fs.readFile(path, 'utf8', function(err, data) {
          console.log("preved");
          if (err) {
            throw err;
          }
          dust.loadSource(dust.compile(data, name));
          console.log("dust path read " + path);
          return callback();
        });
      });
    },
    _getAutoName: function(path) {
      var split;
      split = path.split('.')[0].split('/');
      return split[split.length - 1];
    }
  };
});
